{"ast":null,"code":"import jwt from 'jsonwebtoken';\nimport User from '../models/user.js';\nconst protectRoute = async (req, res, next) => {\n  try {\n    var _req$headers$authoriz;\n    let token = (_req$headers$authoriz = req.headers.authorization) === null || _req$headers$authoriz === void 0 ? void 0 : _req$headers$authoriz.split(\" \")[1]; // Correct token extraction\n    if (!token) {\n      return res.status(401).json({\n        message: \"No token provided\"\n      });\n    }\n\n    // Verify token\n    const decoded = jwt.verify(token, \"welcome\");\n\n    // Fetch user and attach to request\n    req.user = await User.findById(decoded.id).select('-password');\n    next();\n  } catch (error) {\n    res.status(403).json({\n      message: 'Authorization failed'\n    });\n  }\n};\nexport default protectRoute;","map":{"version":3,"names":["jwt","User","protectRoute","req","res","next","_req$headers$authoriz","token","headers","authorization","split","status","json","message","decoded","verify","user","findById","id","select","error"],"sources":["C:/Users/user/Desktop/GIS/client/src/pages/Dashboard.jsx"],"sourcesContent":["import jwt from 'jsonwebtoken';\r\nimport User from '../models/user.js';\r\n\r\nconst protectRoute = async (req, res, next) => {\r\n    try {\r\n        let token = req.headers.authorization?.split(\" \")[1]; // Correct token extraction\r\n        if (!token) {\r\n            return res.status(401).json({ message: \"No token provided\" });\r\n        }\r\n\r\n        // Verify token\r\n        const decoded = jwt.verify(token, \"welcome\");\r\n\r\n        // Fetch user and attach to request\r\n        req.user = await User.findById(decoded.id).select('-password');\r\n\r\n        next();\r\n    } catch (error) {\r\n        res.status(403).json({ message: 'Authorization failed' });\r\n    }\r\n};\r\n\r\nexport default protectRoute;\r\n"],"mappings":"AAAA,OAAOA,GAAG,MAAM,cAAc;AAC9B,OAAOC,IAAI,MAAM,mBAAmB;AAEpC,MAAMC,YAAY,GAAG,MAAAA,CAAOC,GAAG,EAAEC,GAAG,EAAEC,IAAI,KAAK;EAC3C,IAAI;IAAA,IAAAC,qBAAA;IACA,IAAIC,KAAK,IAAAD,qBAAA,GAAGH,GAAG,CAACK,OAAO,CAACC,aAAa,cAAAH,qBAAA,uBAAzBA,qBAAA,CAA2BI,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACtD,IAAI,CAACH,KAAK,EAAE;MACR,OAAOH,GAAG,CAACO,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAAEC,OAAO,EAAE;MAAoB,CAAC,CAAC;IACjE;;IAEA;IACA,MAAMC,OAAO,GAAGd,GAAG,CAACe,MAAM,CAACR,KAAK,EAAE,SAAS,CAAC;;IAE5C;IACAJ,GAAG,CAACa,IAAI,GAAG,MAAMf,IAAI,CAACgB,QAAQ,CAACH,OAAO,CAACI,EAAE,CAAC,CAACC,MAAM,CAAC,WAAW,CAAC;IAE9Dd,IAAI,CAAC,CAAC;EACV,CAAC,CAAC,OAAOe,KAAK,EAAE;IACZhB,GAAG,CAACO,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAAEC,OAAO,EAAE;IAAuB,CAAC,CAAC;EAC7D;AACJ,CAAC;AAED,eAAeX,YAAY","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}